const express = require('express');const authMiddleware = require('../middleware/authMiddleware');const { createGist } = require('../services/githubService');const store = require('../store/memoryStore');const router = express.Router();router.post('/link-repo', authMiddleware, async (req, res) => {  const { repoUrl, projectId, accessToken } = req.body;  if (!repoUrl && !projectId) {    return res.status(400).json({ message: 'Either repoUrl or projectId is required.' });  }  if (projectId) {    const project = store.findProject(p => p.id === projectId && p.userId === req.user.id);    if (!project) {      return res.status(404).json({ message: 'Project not found or you do not have access.' });    }    if (!accessToken) {      return res.status(400).json({ message: 'GitHub access token is required to create a Gist.' });    }    try {      const gistContent = JSON.stringify({        projectName: project.name,        movies: project.movies,        createdAt: project.createdAt,        generatedBy: req.user.username      }, null, 2);      const filename = `${project.name.toLowerCase().replace(/ /g, '-')}-recommendations.json`;      const gist = await createGist(accessToken, filename, gistContent, `Movie recommendations for ${project.name}`);      return res.status(200).json({ message: 'Project data saved to GitHub Gist successfully.', gistUrl: gist.html_url });    } catch (error) {      console.error('Error creating Gist:', error.message);      return res.status(500).json({ message: error.message || 'Failed to create GitHub Gist.' });    }  }  res.status(200).json({ message: `Simulated linking to GitHub repository: ${repoUrl}` });});router.get('/status', authMiddleware, (req, res) => {  res.json({ status: 'GitHub integration active', user: req.user.username });});module.exports = router;